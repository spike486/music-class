<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¤å…¸éŸ³ä¹é­”æ³•å±‹ (è‡ªé€‚åº”ç‰ˆ)</title>
    <link href="https://fonts.googleapis.com/css2?family=Zcool+KuaiLe&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #FFD54F;
            --text: #37474F;
            --bg: #FAFAFA;
        }

        body {
            font-family: 'Zcool KuaiLe', cursive, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            height: 100%;
            /* å…è®¸æ»šåŠ¨ï¼Œé˜²æ­¢æ‰‹æœºç«¯å†…å®¹è¢«æˆªæ–­ */
            overflow-y: auto; 
            overflow-x: hidden;
            user-select: none;
            display: flex;
            flex-direction: column;
        }

        /* å¯¼èˆªæ è‡ªé€‚åº” */
        header {
            background: #fff;
            padding: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-around; /* æ‰‹æœºä¸Šå¹³å‡åˆ†å¸ƒ */
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-btn {
            background: #f0f0f0;
            border: 2px solid #fff;
            padding: 5px 15px;
            border-radius: 30px;
            font-size: 16px; /* æ‰‹æœºä¸Šå­—ä½“ç¨å° */
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
            color: #888;
            white-space: nowrap;
        }

        .nav-btn.active {
            background: var(--primary);
            color: #333;
            border-color: #333;
            transform: scale(1.05);
        }

        main {
            flex: 1;
            position: relative;
            background-image: radial-gradient(#e0e0e0 1px, transparent 1px);
            background-size: 20px 20px;
            width: 100%;
        }

        .scene {
            width: 100%;
            min-height: 100vh; /* ä¿è¯æœ€å°é«˜åº¦å æ»¡å± */
            display: none;
            flex-direction: column;
            align-items: center;
            padding: 20px 10px 80px 10px; /* åº•éƒ¨ç•™ç™½ç»™è§†é¢‘ */
            box-sizing: border-box;
            animation: fadeIn 0.5s;
        }

        .scene.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* é€šç”¨å…ƒç´ è‡ªé€‚åº” */
        .avatar-emoji { font-size: clamp(60px, 15vw, 100px); margin-bottom: 10px; animation: float 3s infinite; }
        .stage-title { font-size: clamp(24px, 6vw, 36px); margin-bottom: 10px; color: #333; text-align: center; }
        .instruction { 
            font-size: clamp(16px, 4vw, 20px); 
            background: rgba(255,255,255,0.9); 
            padding: 10px; 
            border-radius: 15px; 
            margin-bottom: 20px; 
            text-align: center; 
            max-width: 90%;
        }

        /* è§†é¢‘åŒºåŸŸè‡ªé€‚åº” */
        .video-wrapper {
            margin-top: 30px;
            width: 100%;
            max-width: 640px;
            background: #222;
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
            border: 3px solid #fff;
            position: relative;
        }
        .video-wrapper::before {
            content: "ğŸ¬ è§†é¢‘èµæ";
            position: absolute; top: -12px; left: 50%; transform: translateX(-50%);
            background: #FF7043; color: white; padding: 2px 10px;
            border-radius: 10px; font-size: 14px;
        }
        video { width: 100%; aspect-ratio: 16/9; border-radius: 8px; display: block; }

        /* --- åœºæ™¯ç‰¹å®šè‡ªé€‚åº” --- */

        /* æµ·é¡¿ */
        #scene-haydn { background-color: #E0F7FA; }
        .audience-container { font-size: clamp(30px, 8vw, 50px); margin-bottom: 20px; height: 60px; display: flex; gap: 5px; }
        .meter-container { width: 80%; max-width: 300px; height: 20px; background: #ddd; border-radius: 10px; margin-bottom: 20px; border: 2px solid #fff; }
        .meter-fill { height: 100%; width: 0%; background: linear-gradient(90deg, #4CAF50, #FFEB3B, #FF5722); transition: width 0.2s; }
        .conductor-controls { display: flex; gap: 20px; align-items: center; flex-wrap: wrap; justify-content: center; }
        .baton-btn { width: 80px; height: 80px; border-radius: 50%; background: #81C784; border: none; font-size: 30px; cursor: pointer; box-shadow: 0 6px 0 #388E3C; }
        .surprise-btn { width: 100px; height: 100px; border-radius: 50%; background: #ccc; border: none; font-size: 40px; color: white; box-shadow: 0 6px 0 #999; transition: all 0.3s; }
        .surprise-btn.ready { background: #F44336; box-shadow: 0 6px 0 #D32F2F; animation: pulse 1s infinite; }

        /* è«æ‰ç‰¹ */
        #scene-mozart { background-color: #F3E5F5; }
        .star-stage { 
            width: clamp(200px, 60vw, 300px); 
            height: clamp(200px, 60vw, 300px); 
            background: #fff; border-radius: 20px; border: 5px solid #AB47BC; 
            display: flex; justify-content: center; align-items: center; 
            margin-bottom: 20px; position: relative; 
        }
        .base-star { font-size: clamp(80px, 25vw, 140px); color: #FFD700; z-index: 1; }
        .accessory { position: absolute; opacity: 0; transition: 0.5s; }
        .accessory.visible { opacity: 1; }
        .acc-shoes { font-size: clamp(40px, 10vw, 60px); bottom: 10%; right: 10%; z-index: 2; }
        .acc-mask { font-size: clamp(50px, 15vw, 80px); top: 30%; z-index: 3; }
        .acc-crown { font-size: clamp(50px, 15vw, 80px); top: -10%; left: -5%; transform: rotate(-20deg); z-index: 4; }
        
        .wardrobe { display: flex; gap: 10px; justify-content: center; width: 100%; flex-wrap: wrap; }
        .clothing-item { 
            background: #fff; padding: 8px; border-radius: 10px; border: 2px solid #ddd; 
            width: 70px; text-align: center; cursor: pointer; 
        }
        .clothing-item.equipped { border-color: #AB47BC; background: #E1BEE7; transform: translateY(-3px); }
        .clothing-item .icon { font-size: 24px; }
        .clothing-item h4 { margin: 5px 0 0; font-size: 14px; }

        /* è´å¤šèŠ¬ */
        #scene-beethoven { background-color: #E8F5E9; }
        .door-frame { 
            width: clamp(180px, 50vw, 220px); 
            height: clamp(240px, 70vw, 300px); 
            background: #5D4037; border-radius: 15px 15px 0 0; 
            display: flex; flex-direction: column; align-items: center; padding-top: 30px; 
            cursor: pointer; 
        }
        .door-inner { 
            width: 85%; height: 85%; background: #8D6E63; border: 2px dashed #3E2723; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            position: relative; overflow: hidden; 
        }
        .lion-reveal { position: absolute; font-size: 80px; display: none; animation: popIn 0.5s; }
        .lock-lights { display: flex; gap: 8px; margin-bottom: 15px; }
        .light { width: 25px; height: 25px; border-radius: 50%; background: #3E2723; border: 2px solid #aaa; transition: 0.2s; }
        .light.on { background: #FF5252; border-color: #fff; }
        .light.success { background: #69F0AE; }
        
        .rhythm-hint { margin-top: 15px; font-size: 20px; display: flex; gap: 8px; align-items: center; }
        .hint-dot { width: 12px; height: 12px; background: #333; border-radius: 50%; }
        .hint-dash { width: 30px; height: 12px; background: #333; border-radius: 10px; }

        @keyframes pulse { 0% {transform: scale(1);} 50% {transform: scale(1.05);} 100% {transform: scale(1);} }
        @keyframes popIn { 0% {transform: scale(0);} 80% {transform: scale(1.2);} 100% {transform: scale(1);} }
        @keyframes float { 0%, 100% {transform: translateY(0);} 50% {transform: translateY(-10px);} }

    </style>
</head>
<body>

<header>
    <div class="nav-btn active" onclick="switchScene('haydn')">ğŸ˜´ æµ·é¡¿</div>
    <div class="nav-btn" onclick="switchScene('mozart')">ğŸ‘— è«æ‰ç‰¹</div>
    <div class="nav-btn" onclick="switchScene('beethoven')">ğŸ¦ è´å¤šèŠ¬</div>
</header>

<main>
    <!-- åœºæ™¯1ï¼šæµ·é¡¿ -->
    <div id="scene-haydn" class="scene active">
        <div class="avatar-emoji">ğŸ‘´</div>
        <div class="stage-title">æµ·é¡¿çˆ·çˆ·çš„æ¶ä½œå‰§</div>
        <div class="instruction">ä»»åŠ¡ï¼šè½»è½»ç‚¹ç»¿è‰²æŒ‡æŒ¥ï¼Œèƒ½é‡æ»¡äº†æŒ‰çº¢è‰²æŒ‰é’®ï¼</div>
        
        <div class="audience-container">
            <span class="audience">ğŸ˜´</span><span class="audience">ğŸ˜´</span>
            <span class="audience">ğŸ˜´</span><span class="audience">ğŸ˜´</span>
        </div>

        <div class="meter-container"><div id="haydn-meter" class="meter-fill"></div></div>

        <div class="conductor-controls">
            <button class="baton-btn" onclick="tapSoftly()">ğŸ¼</button>
            <button id="surprise-btn" class="surprise-btn" onclick="triggerSurprise()">ğŸ’¥</button>
        </div>

        <div class="video-wrapper">
            <!-- å…¼å®¹è·¯å¾„ï¼švideos/haydn.mp4 æˆ– haydn.mp4 -->
            <video controls>
                <source src="videos/haydn.mp4" type="video/mp4">
                <source src="haydn.mp4" type="video/mp4">
            </video>
        </div>
    </div>

    <!-- åœºæ™¯2ï¼šè«æ‰ç‰¹ -->
    <div id="scene-mozart" class="scene">
        <div class="avatar-emoji">ğŸ‘¶</div>
        <div class="stage-title">å°æ˜Ÿæ˜Ÿå˜è£…ç§€</div>
        <div class="instruction">ä»»åŠ¡ï¼šç‚¹å‡»è¡£æœï¼Œç»™å°æ˜Ÿæ˜Ÿç©¿ä¸Šä¸åŒçš„â€œå˜å¥â€ï¼</div>

        <div class="star-stage">
            <div id="main-star" class="base-star">â­</div>
            <div id="acc-shoes" class="accessory acc-shoes">ğŸ‘Ÿ</div>
            <div id="acc-mask" class="accessory acc-mask">ğŸ­</div>
            <div id="acc-crown" class="accessory acc-crown">ğŸ‘‘</div>
        </div>

        <div class="wardrobe">
            <div class="clothing-item" id="item-shoes" onclick="toggleOutfit('shoes')">
                <div class="icon">ğŸ‘Ÿ</div><h4>è·‘é‹</h4>
            </div>
            <div class="clothing-item" id="item-mask" onclick="toggleOutfit('mask')">
                <div class="icon">ğŸ­</div><h4>é¢å…·</h4>
            </div>
            <div class="clothing-item" id="item-crown" onclick="toggleOutfit('crown')">
                <div class="icon">ğŸ‘‘</div><h4>çš‡å† </h4>
            </div>
        </div>

        <div class="video-wrapper">
            <video controls>
                <source src="videos/mozart.mp4" type="video/mp4">
                <source src="mozart.mp4" type="video/mp4">
            </video>
        </div>
    </div>

    <!-- åœºæ™¯3ï¼šè´å¤šèŠ¬ -->
    <div id="scene-beethoven" class="scene">
        <div class="avatar-emoji">ğŸ¦</div>
        <div class="stage-title">è´å¤šèŠ¬çš„å¯†ç é—¨</div>
        <div class="instruction">ä»»åŠ¡ï¼šæŒ‰â€œçŸ­-çŸ­-çŸ­-é•¿â€çš„èŠ‚å¥æ•²é—¨ï¼</div>

        <div class="lock-lights">
            <div id="light-1" class="light"></div>
            <div id="light-2" class="light"></div>
            <div id="light-3" class="light"></div>
            <div id="light-4" class="light"></div>
        </div>

        <div class="door-frame">
            <div class="door-inner">
                <div class="knocker" onclick="tapDoor()" style="position:absolute; width:100%; height:100%; z-index:10;"></div>
                <div style="font-size: 60px; opacity: 0.2">ğŸšª</div>
                <div id="lion" class="lion-reveal">ğŸ¦</div>
            </div>
        </div>

        <div class="rhythm-hint">
            æç¤ºï¼š<div class="hint-dot"></div><div class="hint-dot"></div><div class="hint-dot"></div><div class="hint-dash"></div>
        </div>

        <div class="video-wrapper">
            <video controls>
                <source src="videos/beethoven.mp4" type="video/mp4">
                <source src="beethoven.mp4" type="video/mp4">
            </video>
        </div>
    </div>
</main>

<script>
    // éŸ³é¢‘ä¸é€»è¾‘ä¿æŒä¸å˜ (Compact JS)
    const AudioContext=window.AudioContext||window.webkitAudioContext;const audioCtx=new AudioContext;
    function playNote(f,t,d,v=0.5,s=0){if(audioCtx.state==='suspended')audioCtx.resume();const o=audioCtx.createOscillator();const g=audioCtx.createGain();o.type=t;o.frequency.setValueAtTime(f,audioCtx.currentTime+s);g.gain.setValueAtTime(v,audioCtx.currentTime+s);g.gain.exponentialRampToValueAtTime(0.01,audioCtx.currentTime+s+d);o.connect(g);g.connect(audioCtx.destination);o.start(audioCtx.currentTime+s);o.stop(audioCtx.currentTime+s+d);}
    function switchScene(id){document.querySelectorAll('.scene').forEach(s=>s.classList.remove('active'));document.getElementById('scene-'+id).classList.add('active');document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));event.target.closest('.nav-btn').classList.add('active');document.querySelectorAll('video').forEach(v=>v.pause());}
    
    // æµ·é¡¿
    let haydnEnergy=0;
    function tapSoftly(){playNote(440+Math.random()*100,'sine',0.2,0.1);haydnEnergy+=20;document.getElementById('haydn-meter').style.width=haydnEnergy+'%';if(haydnEnergy>=100){document.getElementById('surprise-btn').classList.add('ready');document.getElementById('surprise-btn').disabled=false;}}
    function triggerSurprise(){if(haydnEnergy<100)return;playNote(196,'sawtooth',1,1);playNote(293,'sawtooth',1,1);playNote(392,'sawtooth',1,1);document.querySelectorAll('.audience').forEach(a=>{a.textContent='ğŸ˜³';a.classList.add('awake');});haydnEnergy=0;document.getElementById('haydn-meter').style.width='0%';document.getElementById('surprise-btn').classList.remove('ready');document.getElementById('surprise-btn').disabled=true;}
    
    // è«æ‰ç‰¹
    let outfit={shoes:false,mask:false,crown:false};
    function toggleOutfit(item){outfit[item]=!outfit[item];const btn=document.getElementById('item-'+item);const acc=document.getElementById('acc-'+item);if(outfit[item]){btn.classList.add('equipped');acc.classList.add('visible');}else{btn.classList.remove('equipped');acc.classList.remove('visible');}playMozartVariation();}
    function playMozartVariation(){let t='sine';let n=[];if(outfit.mask){document.getElementById('main-star').style.filter='grayscale(100%)';t='triangle';n=[{f:523,d:0.5},{f:622,d:0.5},{f:783,d:0.5},{f:622,d:0.5},{f:523,d:1}];}else{document.getElementById('main-star').style.filter='none';if(outfit.shoes){t='square';n=[{f:523,d:0.1},{f:587,d:0.1},{f:659,d:0.1},{f:698,d:0.1},{f:783,d:0.1},{f:880,d:0.1},{f:783,d:0.3}];}else if(outfit.crown){t='sawtooth';n=[{f:523,d:0.2},{f:587,d:0.1},{f:523,d:0.1},{f:783,d:0.2},{f:880,d:0.1},{f:783,d:0.4}];}else{n=[{f:523,d:0.3},{f:523,d:0.3},{f:783,d:0.3},{f:783,d:0.3},{f:880,d:0.3},{f:880,d:0.3},{f:783,d:0.6}];}}let now=0;n.forEach(x=>{playNote(x.f,t,x.d,0.3,now);now+=x.d*(outfit.mask?1.2:0.8);});}

    // è´å¤šèŠ¬
    let tapCount=0;
    function tapDoor(){tapCount++;document.querySelector('.door-inner').style.transform='scale(0.95)';setTimeout(()=>document.querySelector('.door-inner').style.transform='scale(1)',100);if(tapCount<4){playNote(392,'square',0.2,0.5);document.getElementById('light-'+tapCount).classList.add('on');}else if(tapCount===4){playNote(311,'square',1.5,0.8);document.getElementById('light-4').classList.add('on');document.querySelectorAll('.light').forEach(l=>l.classList.add('success'));document.getElementById('lion').style.display='block';setTimeout(()=>{tapCount=0;document.querySelectorAll('.light').forEach(l=>{l.classList.remove('on');l.classList.remove('success');});document.getElementById('lion').style.display='none';},3000);}}
</script>

</body>
</html>
